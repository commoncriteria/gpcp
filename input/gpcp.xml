<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../transforms/pp2html.xsl"?>

<!-- to do
    
   Starting from Virt PP and adapting.
   
    -->

<?xml-model href="CCProtectionProfile.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>    

<!-- TITLE PAGE -->

<PP xmlns="https://niap-ccevs.org/cc/v1" name="GPCPPP"
    xmlns:h="http://www.w3.org/1999/xhtml" boilerplate="yes">
    <PPReference>
        <ReferenceTable>
            <PPTitle>Protection Profile for General-Purpose Computing Platforms</PPTitle>
            <PPVersion>0.1</PPVersion>
            <PPAuthor>National Information Assurance Partnership</PPAuthor>
            <PPPubDate>2019-12-13</PPPubDate>
            <Keywords>GPCP</Keywords>
        </ReferenceTable>
    </PPReference>
	
    <!-- REVISION HISTORY -->
    
    <RevisionHistory>
        <entry>
            <version>0.1</version>
            <date>2019-12-13</date>
            <subject>Initial Draft</subject>
        </entry>
    </RevisionHistory>
	
    <!-- TABLE OF CONTENTS goes here -->
    
    <!-- INTRODUCTION -->
    
    <chapter id="intro" title="Introduction">
        <section id="overview" title="Overview">
            The scope of this Protection Profile (PP) is to describe the security functionality of general-purpose computing platforms 
		in terms of [CC] and to define security functional and assurance requirements for such products. 
            <h:br></h:br>
        </section>

	<tech-terms>
	  <term full="Administrator">Administrators perform management activities on the platform. These management functions do not
		  include administration of tenant software running on the platform. Generally only server platforms have
		  administrators that act through a Service Processor. Administrators may be no more than software entities.</term>
	  <term abbr="AES" full="Advanced Encryption Standard"/>
	  <term full="Auditor">Auditors are responsible for managing the audit capabilities of the TOE. An Auditor may also be an
		  Administrator. It is not a requirement that the TOE be capable of supporting an Auditor role that is separate from
		  that of an Administrator.</term>
          <term abbr="CPU" full="Central Processing Unit"/>
          <term abbr="DEP" full="Data Execution Prevention"/>
          <term abbr="DKM" full="Derived Keying Material"/>
	  <term full="Domain">A Domain or Information Domain is a policy construct that groups together execution environments and 
		  networks by sensitivity of information and access control policy. For example, classification levels represent 
		  information domains. Within classification levels, there might be other domains representing communities of interest
		  or coalitions.</term>
          <term abbr="DSS" full="Digital Signature Standard"/>
          <term abbr="ECC" full="Elliptic Curve Cryptography"/>
          <term abbr="FIPS" full="Federal Information Processing Standard"/>
          <term abbr="FFC" full="Finite-Field Cryptography"/>
	  <term abbr="GPCP" full="General-Purpose Computing Platform"/>
          <term abbr="IEC" full="International Electrotechnical Commission"/>
	  <term full="Information Domain">See Domain.</term>
	  <term full="Introspection">A capability that allows a specially designated and privileged domain to have visibility into
		  another domain for purposes of anomaly detection or monitoring.</term>
          <term abbr="ISO" full="International Organization for Standardization"/>
          <term abbr="IP" full="Internet Protocol"/>
          <term abbr="IT" full="Information Technology"/>
          <term abbr="ITSEF" full="Information Technology Security Evaluation Facility"/>
          <term abbr="KDF" full="Key Derivation Function"/>
          <term abbr="MAC" full="Message Authentication Code"/>
          <term abbr="NIST" full="National Institute of Standards and Technology"/>
          <term abbr="NVLAP" full="National Voluntary Laboratory Accreditation Program"/>
          <term abbr="OS" full="Operating System"/>
          <term abbr="PKV" full="Public Key Verification"/>
	  <term full="Platform">The hardware and firmware on which tenant software executes. For this PP, the TOE is the platform,
		  hence there is no "TOE Platform."</term>
          <term abbr="RSA" full="Rivest, Shamir, Adleman"/>
          <term abbr="SP" full="Special Publication"/>
          <term abbr="SPD" full="Security Policy Database"/>
	  <term full="System Security Policy" abbr="SSP">The overall policy enforced by the TOE defining constraints on the behavior 
		  of the platform and on tenant software.</term>
          <term abbr="SWID" full="Software Identification"/>
          <term abbr="TPM" full="Trusted Platform Module"/>
	  <term full="User">Users are entities that operate within the environment created by the TOE. The two kinds of users are
		  Administrators and Tenants. Users need not be human. As far as the TOE is concerned, all users are just software.</term>
	</tech-terms>
	    
	<!-- Compliant Targets of Evaluation -->
        <section id="complianttargets" title="Compliant Targets of Evaluation">
	    A platform is a collection of hardware devices and firmware that provide the functional capabilities and services needed
		by tenant software. Such devices typically include embedded controllers, trusted platform modules, management 
		controllers, host processors, network interface controllers, graphics processing units, flash memory, storage 
		controllers, storage devices, boot firmware, runtime firmware, and a power supply.<h:br></h:br><h:br></h:br>
	    A general-purpose computing platform is a hardware device that it capable of hosting more than one different operating 
		system, virtualization system, or bare-metal application. Typical platform implementations include servers, PC 
		clients, laptops, and tablets.<h:br></h:br><h:br></h:br>
	    The PP does not apply to mobile devices (as defined by the Protection Profile for Mobile Device Fundamentals), network devices
		(as defined by the Collaborative Protection Profile for Network Devices), or to IoT devices.
		
            <subsection id="toeboundary" title="TOE Boundary">
		The TOE is composed of hardware and firmware capable of running general-purpose software. This typically includes motherboards,
		    embedded controllers, trusted platform modules, management controllers, host processors, network interface controllers, 
		    graphics processing units, flash memory, storage controllers, storage devices, boot firmware, runtime firmware, 
		    and a power supply.<h:br></h:br><h:br></h:br>
		The TOE does not include tenant software and customer workloads such as operating systems, virtualization systems, 
		    and applications. Firmware that comes pre-installed on the platform is considered to be part of the platform--whether its 
		    purpose is to support the functioning of the platform itself or to support tenant workloads. For example, a server's Service Processor
		    and its firmware are considered part of the server platform.
            </subsection>

            <subsection id="scopecert" title="Scope of Certification">
                Successful evaluation of a General-Purpose Computing Platform against this profile does not constitute or imply successful 
		    evaluation of any tenant software no matter how tightly integrated with the platform.
            </subsection>
		
            <subsection id="equiv" title="Product and Platform Equivalence">
                The tests in this Protection Profile must be run for all Platforms with which the Vendor would
		    like to claim compliance—subject to this Profile’s equivalency guidelines (see Annex E).
            </subsection>
        </section>

        <section id="usecases" title="Use Cases">
            This PP defines use cases for server platforms and client platforms:<h:br></h:br><h:br></h:br>

		<h:b>Client Use Case:</h:b> <h:br></h:br><h:br></h:br>
		Client platforms are computers that run an operating system or virtualization system on behalf of a user that is 
		generally physically present at the machine. Examples include tablet computers, laptops, and desktop computers or
		workstations.<h:br></h:br><h:br></h:br>

		<h:b>Server Use Case:</h:b> <h:br></h:br><h:br></h:br>
		Servers platforms are computers that run an operating system or virtualization system in a data center or server 
		environment on behalf of one or more users, or an enterprise. Generally, there is no user physically present at the 
		machine. Server platforms often include integrated management subsystems.<h:br></h:br><h:br></h:br>

        </section>
    </chapter>
    
    <!-- CONFORMANCE CLAIMS -->

    <chapter id="claims" title="Conformance Claims"/>
<!--        <cclaims>
            <cclaim id="statement">
                <description>
                    To be conformant to this PP, an <abbr linkend="ST"/> must demonstrate Exact Conformance, a subset of Strict 
			Conformance as defined in [<abbr linkend="CC"/>] Part 1 (ASE_CCL). The <abbr linkend="ST"/> must include all
 			components in this PP that are:
                    <h:ul>
                        <h:li>Unconditional (which are always required)</h:li>
                        <h:li>Selection-based (which are required when certain selections are chosen in the unconditional requirements)
                            and may include components that are</h:li>
                        <h:li>Optional</h:li>
                        <h:li>Objective.</h:li>
                    </h:ul>
                    Unconditional requirements are found in the main body of the document (Section 5), while appendices contain the 
			selection-based, optional, and objective requirements. The <abbr linkend="ST"/> may iterate any of these
 			components but it must not introduce any additional component (e.g., from <abbr linkend="CC"/> Part 2 or 3) 
			that is not defined in this PP.
                </description>
            </cclaim>
            <cclaim id="claims">
                <description>
                    This PP is conformant to Parts 2 (extended) and 3 (extended) of Common Criteria Version 3.1, Revision 4 [<abbr linkend="CC"/>].
                </description>
            </cclaim>
            <cclaim id="ppclaim">
                <description>
                    This PP does not claim conformance to any Protection Profile.
                </description>
            </cclaim>
            <cclaim id="packageclaim">
                <description>
                    This PP does not claim conformance to any packages.
                </description>
            </cclaim>
        </cclaims>
    </chapter>
-->
    <!-- SECURITY PROBLEM DESCRIPTION -->

    <chapter id="desc" title="Security Problem Description">
	    
	<!-- Threats -->
        <section id="threats" title="Threats">
            <threats>
                <threat id="T.PLATFORM_COMPROMISE">
                    <description>
                        The TOE must be capable of protecting itself from threats that originate from tenant software and operational
			    networks connected to the TOE. The hosting of untrusted or malicious tenant software by the GPCP cannot be 
			    permitted to compromise the security and integrity of the platform. 
                    </description>
                    <objective-refer ref="O.PLATFORM_INTEGRITY">
                        <rationale>Platform integrity mechanisms used by the <abbr linkend="TOE"/> reduce the risk that an attacker
				can affect the platform.</rationale>
                    </objective-refer>
                </threat>
            </threats>
        </section>
        
	<!-- Assumptions -->
        <section id="assumptions" title="Assumptions">
            <assumptions>
                <assumption id="A.PHYSICAL">
                    <description>Physical security commensurate with the value of the <abbr linkend="TOE"/> and the data it contains
			    is assumed to be provided by the environment.</description>
                    <objective-refer ref="OE.PHYSICAL">
                        <rationale>If the <abbr linkend="TOE"/> is deployed in a location that has appropriate physical safeguards, 
				it can be assumed to be physically secure.</rationale>
                    </objective-refer>
                </assumption>
                <assumption id="A.TRUSTED_ADMIN">
                    <description><abbr linkend="TOE"/> Administrators are trusted to follow and apply all administrator guidance.</description>
                    <objective-refer ref="OE.TRUSTED_ADMIN">
                        <rationale>Providing guidance to administrators and ensuring that individuals are properly trained and 
				vetted before being given administrative responsibilities will ensure that they are trusted.</rationale>
                    </objective-refer>
                </assumption>
                <assumption id="A.COVERT_CHANNELS">
                    <description>If the <abbr linkend="TOE"/> has covert storage or timing channels, then for all tenant software executing on
			    that TOE, it is assumed that relative to the IT assets to which they have access, the tenant software will have 
			    assurance sufficient to outweigh the risk that they will violate the security policy of the TOE by using those
			    covert channels.</description>
                    <objective-refer ref="OE.COVERT_CHANNELS">
                        <rationale>It is expected that any data contained within tenant software is commensurate with the security provided
				by the <abbr linkend="TOE"/>, which includes any vulnerabilities due to the potential presence of covert
				storage and/or timing channels.</rationale>
                    </objective-refer>
                </assumption>
             </assumptions>
        </section>

	<!-- Operational Security Policies -->
	<section id="secpolicies" title="Organizational Security Policies">
            There are no organizational security policies defined for this PP.
        </section>
    </chapter>
    
    <!-- SECURITY OBJECTIVES -->
    
    <chapter id="obj" title="Security Objectives">
	    
	<!-- Security Objectives for the TOE -->
        <section id="secobjtoe" title="Security Objectives for the TOE">
            <SOs>
                <SO id="O.PLATFORM_INTEGRITY">
                    <description>
			    Since the TOE is a platform, this objective probably shouldn't be here. So this is just a placeholder.
			    The integrity of the TOE depends on the integrity of the software on which the TOE relies. Although 
			    the TOE does not have complete control over the integrity of the platform, the TOE should as much as
			    possible try to ensure that no users or software hosted by the TOE is capable of undermining the integrity
			    of the platform.
                    </description>
		    <addressed-by>
		      FDP_HBI_EXT.1, FDP_PPR_EXT.1, FDP_VMS_EXT.1,
		      FDP_VNC_EXT.1, FPT_DVD_EXT.1, FPT_EEM_EXT.1,
		      FPT_HAS_EXT.1, FPT_HAS_EXT.1, FPT_HCL_EXT.1,
		      FPT_VDP_EXT.1, FPT_VIV_EXT.1
		    </addressed-by>
                </SO>
            </SOs>
        </section>

	<!-- Security Objectives for the Operational Environment -->
	<section id="secobjoe" title="Security Objectives for the Operational Environment">
            <SOEs>
                <SOE id="OE.CONFIG">
                    <description><abbr linkend="TOE"/> administrators will configure the Virtualization System correctly to create 
			    the intended security policy.
                    </description>
                </SOE>
                <SOE id="OE.PHYSICAL">
                    <description>Physical security, commensurate with the value of the <abbr linkend="TOE"/> and the data it contains,
			    is provided by the environment.
                    </description>
                </SOE>
                <SOE id="OE.TRUSTED_ADMIN">
                    <description><abbr linkend="TOE"/> Administrators are trusted to follow and apply all administrator guidance in 
			    a trusted manner.
                    </description>
                </SOE>
                <SOE id="OE.COVERT_CHANNELS">
                    <description>If the <abbr linkend="TOE"/> has covert storage or timing channels, then for all
			    <abbr linkend="VM"/>s executing on that <abbr linkend="TOE"/>, it is assumed that those 
			    <abbr linkend="VM"/>s will have sufficient assurance relative to the IT assets to which they have access, 
			    to outweigh the risk that they will violate the security policy of the <abbr linkend="TOE"/> by using 
			    those covert channels.
                    </description>
                </SOE>
                <SOE id="OE.NON_MALICIOUS_USER">
                    <description>Users are trusted to be not willfully negligent or hostile and use the TOE in compliance with the 
			    applied enterprise security policy and guidance.
                    </description>
                </SOE>
            </SOEs>
        </section>
    </chapter>
    
    <!-- SECURITY REQUIREMENTS -->
    
    <chapter id="req" title="Security Requirements">
        <section id="sfr" title="TOE Security Functional Requirements">
            The Security Functional Requirements (SFRs) included in this section are derived from Part 2 of the Common Criteria for 
		Information Technology Security Evaluation, Version 3.1, Revision 4, with additional extended functional components.<h:br></h:br><h:br></h:br>
            The <abbr linkend="CC"/> defines operations on Security Functional Requirements: assignments, selections, assignments 
		within selections and refinements.

	    <!-- Audit -->
            <subsection id="fau" title="Security Audit (FAU)">
		    
  	        <!-- FAU_GEN.1 -->
                <f-component id="fau_gen.1" name="Audit Data Generation">
                    <f-element>
                        <title>The <abbr linkend="TSF"/> shall be able to generate an audit record of the following auditable events:
                            <h:ol type="a">
                                <h:li>Start-up and shutdown of audit functions</h:li>
                                <h:li>All administrative actions</h:li>
                                <h:li>[Specifically defined auditable events in Table 1]</h:li>

				<!-- Problem here is that audit events can be:
					-- included in the ST if the SFR is included (this is default behavior)
					   --  in the table depending on what section the SFR is
					-- But then it can also have a separate selection dependency. 
	
				     Real problem is how do we display the audit events in a separate table if they are separately
					selectable--as is the case with Virt Table 3 or MDF Table 4.
				  	Because this is a nice way to present them and then have a selection in FAU_GEN.
					But this need not be the way. E.g. inclusion could depend on 
				 -->
				    
				    <h:li><selectables>
                                    <selectable>audit events defined in Table 2 for included optional SFRs</selectable>
                                    <selectable>audit events defined in Table 3</selectable>
                                    <selectable>audit events defined in Table 4 for included selection-based SFRs</selectable>
                                    <selectable>audit events defined in Table 5 for included objective SFRs</selectable>
                                    <selectable>no other information</selectable>
                                </selectables></h:li>
                            </h:ol>
                        </title>
                    </f-element>
                    <f-element>
                        <title>The <abbr linkend="TSF"/> shall record within each audit record at least the following information:
                            <h:ol type="a">
                                <h:li>Date and time of the event</h:li>
                                <h:li>Type of event</h:li>
                                <h:li>Subject and object identity (if applicable)</h:li>
                                <h:li>The outcome (success or failure) of the event</h:li>
                                <h:li>[Additional information defined in Table 1]</h:li>
                                <h:li><selectables>
                                    <selectable>additional information defined in Table 2</selectable>
                                    <selectable>additional information defined in Table 3</selectable>
                                    <selectable>additional information defined in Table 4</selectable>
                                    <selectable>additional information defined in in Table 5</selectable>
                                    <selectable>no other information</selectable>
                                </selectables></h:li>
                            </h:ol>
                        </title>
                        <note role="application">
                            The <abbr linkend="ST"/> author can include other auditable events directly in Table 1; they are not limited to
				the list presented. The <abbr linkend="ST"/> author should update the table in FAU_GEN.1.2 with any additional
				information generated. “Subject identity” in FAU_GEN.1.2 could be a user id or an identifier specifying a 
				<abbr linkend="VM"/>, for example.<h:br></h:br><h:br></h:br>
                            If ‘additional information defined in Table 3’ is selected, it is acceptable to include individual
                            entries from Table 3 without including the entirety of Table 3.  Appropriate entries from Tables 2, 4,
                            and 5 should be included in the <abbr linkend="ST"/> if the associated SFRs and selections are included.
				<h:br></h:br><h:br></h:br>
                            The Table 1 entry for FDP_VNC_EXT.1 refers to configuration settings that attach <abbr linkend="VM"/>s to 
				virtualized network components. Changes to these configurations can be made during <abbr linkend="VM"/> 
				execution or when <abbr linkend="VM"/>s are not running. Audit records must be generated for either case.
				<h:br></h:br><h:br></h:br>
                            The intent of the audit requirement for FDP_PPR_EXT.1 is to log that the <abbr linkend="VM"/> is connected to a
				physical device (when the device becomes part of the <abbr linkend="VM"/>’s hardware view), not to log every
				time that the device is accessed. Generally, this is only once at <abbr linkend="VM"/> startup. However,
				some devices can be connected and disconnected during operation (e.g., virtual USB devices such as CD-ROMs). 
				All such connection/disconnection events must be logged.
                        </note>
			<aactivity>
                            <TSS>
                                The evaluator shall check the <abbr linkend="TSS"/> and ensure that it lists all of the auditable events 
                                and provides a format for audit records. Each audit record format type shall be covered, along with a 
                                brief description of each field. The evaluator shall check to make sure that every audit event type 
                                mandated by the PP is described in the <abbr linkend="TSS"/>.<h:br></h:br><h:br></h:br>
                            </TSS>
                            <Guidance>
                                The evaluator shall also make a determination of the administrative actions that are relevant in the 
                                context of this PP. The evaluator shall examine the administrative guide and make a determination of which 
                                administrative commands, including subcommands, scripts, and configuration files, are related to the 
                                configuration (including enabling or disabling) of the mechanisms implemented in the <abbr linkend="TOE"/> 
                                that are necessary to enforce the requirements specified in the PP. The evaluator shall document the 
                                methodology or approach taken while determining which actions in the administrative guide are 
                                security-relevant with respect to this PP.<h:br></h:br><h:br></h:br>
                            </Guidance>
                            <Tests>
                                The evaluator shall test the <abbr linkend="TOE"/>’s ability to correctly generate audit records by 
                                having the <abbr linkend="TOE"/> generate audit records for the events listed and administrative actions. 
                                For administrative actions, the evaluator shall test that each action determined by the evaluator above to 
                                be security relevant in the context of this PP is auditable. When verifying the test results, the 
                                evaluator shall ensure the audit records generated during testing match the format specified in the 
                                administrative guide, and that the fields in each audit record have the proper entries.<h:br></h:br>
                                <h:br></h:br>
                                Note that the testing here can be accomplished in conjunction with the testing of the security mechanisms 
                                directly.<h:br></h:br>
				    
				    							
			See <ctr-ref refid="audit-table">: Auditable Events</ctr-ref> for more information.

			<!-- AUDIT TABLE for MANDATORY SFRs. This needs to move outside the EAs -->
                        <audit-events table="mandatory"/><h:br/>
                        <ctr id="audit-table" ctr-type="Table">: Auditable Events</ctr>
                            </Tests>   
                        </aactivity>
                    </f-element>
		    <audit-event>
                        <table known="mandatory"/>
			<description>None.</description>
                        <add-info>None.</add-info>
		    </audit-event>
                </f-component>
            </subsection>
            
	    <!-- Cryptographic Support -->
	    <subsection id="fcs" title="Cryptographic Support">
                
                <!-- FCS_CKM.1 -->
                <f-component id="fcs_ckm.1" name="Cryptographic Key Generation">
                    <f-element>
                        <title> The <abbr linkend="TSF"/> shall generate asymmetric cryptographic keys in accordance with a specified 
				cryptographic key generation algorithm
                            <selectables linebreak="yes">
                                <selectable>
                                    RSA schemes using cryptographic key sizes [2048-bit or greater] that meet the following:
					[FIPS PUB 186-4, “Digital Signature Standard (DSS)”, Appendix B.3]
                                </selectable>
                                <selectable>
                                    ECC schemes using [“NIST curves” P-256, P-384, and
                                    <selectables>
                                        <selectable> P-521 </selectable>
                                        <selectable> no other curves </selectable>
                                    </selectables>
                                    that meet the following: [FIPS PUB 186-4, “Digital Signature Standard (DSS)”, Appendix B.4]
                                    </selectable>
                                <selectable>
                                    FFC schemes using cryptographic key sizes [2048-bit or greater] that meet the following: 
					[FIPS PUB 186-4, “Digital Signature Standard (DSS)”, Appendix B.1]].
                                </selectable>
                            </selectables>.
                        </title>
                        <note role="application">The <abbr linkend="ST"/> author selects all key generation schemes used for key
				establishment and device authentication. When key generation is used for key establishment, the 
				schemes in FCS_CKM.2.1 and selected cryptographic protocols shall match the selection. When key
				generation is used for device authentication, the public key is expected to be associated with an
				X.509v3 certificate.<h:br></h:br><h:br></h:br>
                            If the <abbr linkend="TOE"/> acts as a receiver in the RSA key establishment scheme, the 
				<abbr linkend="TOE"/> does not need to implement RSA key generation.
                        </note>
                        <aactivity>
                            <TSS>
                                The evaluator shall ensure that the <abbr linkend="TSS"/> identifies the key sizes supported by 
                                the <abbr linkend="TOE"/>. If the <abbr linkend="ST"/> specifies more than one scheme, the 
                                evaluator shall examine the <abbr linkend="TSS"/> to verify that it identifies the usage for each 
                                scheme.
                            </TSS>
                            <Guidance>
                                The evaluator shall verify that the AGD guidance instructs the administrator how to configure 
                                the <abbr linkend="TOE"/> to use the selected key generation scheme(s) and key size(s) for all 
                                uses defined in this PP.
                            </Guidance>
                            <Tests>
                                Note: The following tests require the developer to provide access to a test platform that 
                                provides the evaluator with tools that are typically not found on factory products.<h:br></h:br><h:br></h:br>
                                <h:b>Key Generation for FIPS PUB 186-4 RSA Schemes</h:b><h:br></h:br>
                                The evaluator shall verify the implementation of RSA Key Generation by the <abbr linkend="TOE"/> 
				    using the Key Generation test. This test verifies the ability of the <abbr linkend="TSF"/> to
				    correctly produce values for the key components including the public verification exponent e, 
				    the private prime factors p and q, the public modulus n and the calculation of the private
				    signature exponent d.<h:br></h:br><h:br></h:br>
                                Key Pair generation specifies 5 ways (or methods) to generate the primes p and q. These include:<h:br></h:br><h:br></h:br>
                                <h:ul>
                                    <h:li> Random Primes:
                                        <h:ul>
                                            <h:li>Provable primes</h:li>
                                            <h:li>Probable primes</h:li>
                                        </h:ul>
                                    </h:li>
                                    <h:li> Primes with Conditions:
                                        <h:ul>
                                            <h:li>Primes p1, p2, q1,q2, p and q shall all be provable primes</h:li>
                                            <h:li>Primes p1, p2, q1, and q2 shall be provable primes and p and q shall be
                                                probable primes</h:li>
                                            <h:li>Primes p1, p2, q1,q2, p and q shall all be probable primes</h:li>
                                        </h:ul>
                                    </h:li>
                                </h:ul><h:br></h:br><h:br></h:br>
                                To test the key generation method for the Random Provable primes method and for all the Primes with 
				    Conditions methods, the evaluator shall seed the <abbr linkend="TSF"/> key generation routine with
				    sufficient data to deterministically generate the RSA key pair. This includes the random seed(s),
				    the public exponent of the RSA key, and the desired key length. For each key length supported, the 
				    evaluator shall have the <abbr linkend="TSF"/> generate 25 key pairs. The evaluator shall verify
				    the correctness of the <abbr linkend="TSF"/>’s implementation by comparing values generated by the 
				    <abbr linkend="TSF"/> with those generated from a known good implementation.
				    <h:br></h:br><h:br></h:br>
                                <h:b>Key Generation for Elliptic Curve Cryptography (ECC)</h:b><h:br></h:br><h:br></h:br>
                                <h:p> FIPS 186-4 ECC Key Generation Test</h:p><h:br></h:br><h:br></h:br>
                                For each supported NIST curve, i.e., P-256, P-384 and P-521, the evaluator shall require the 
				    implementation under test (IUT) to generate 10 private/public key pairs. The private key shall be
				    generated using an approved random bit generator (RBG). To determine correctness, the evaluator
				    shall submit the generated key pairs to the public key verification (PKV) function of a known good
				    implementation.
                                <h:br/>
                                <h:p>FIPS 186-4 Public Key Verification (PKV) Test</h:p>
                                For each supported NIST curve, i.e., P-256, P-384 and P-521, the evaluator shall generate 10 
				    private/public key pairs using the key generation function of a known good implementation and
				    modify five of the public key values so that they are incorrect, leaving five values unchanged
				    (i.e., correct). The evaluator shall obtain in response a set of 10 PASS/FAIL values.
				    <h:br></h:br><h:br></h:br>
                                <h:b>Key Generation for Finite-Field Cryptography (FFC)</h:b><h:br></h:br><h:br></h:br>
                                The evaluator shall verify the implementation of the Parameters Generation and the Key Generation for
				    FFC by the <abbr linkend="TOE"/> using the Parameter Generation and Key Generation test. This test
				    verifies the ability of the <abbr linkend="TSF"/> to correctly produce values for the field prime
				    p, the cryptographic prime q (dividing p-1), the cryptographic group generator g, and the
				    calculation of the private key x and public key y.<h:br></h:br><h:br></h:br>
                                The Parameter generation specifies 2 ways (or methods) to generate the cryptographic prime q and the
				    field prime p:<h:br></h:br><h:br></h:br>
                                <h:ul>
                                    <h:li>Primes q and p shall both be provable primes</h:li>
                                    <h:li>Primes q and field prime p shall both be probable primes</h:li>
                                </h:ul>
                                and two ways to generate the cryptographic group generator g:
                                <h:ul>
                                    <h:li>Generator g constructed through a verifiable process</h:li>
                                    <h:li>Generator g constructed through an unverifiable process.</h:li>
                                </h:ul>
                                The Key generation specifies 2 ways to generate the private key x:
                                <h:ul>
                                    <h:li>len(q) bit output of RBG where  1 &#2264; x &#2264; q-1 <!-- the special characters 1 <=x <= q-1 --></h:li>
                                    <h:li>len(q) + 64 bit output of RBG, followed by a mod q-1 operation where 1 &#2264; x &#2264; q-1 <!-- 1<= x<=q-1. --></h:li>
                                </h:ul><h:br></h:br><h:br></h:br>
                                The security strength of the RBG shall be at least that of the security offered by the FFC parameter
				    set.<h:br></h:br><h:br></h:br>
                                To test the cryptographic and field prime generation method for the provable primes method and/or the
				    group generator g for a verifiable process, the evaluator shall seed the <abbr linkend="TSF"/> 
				    parameter generation routine with sufficient data to deterministically generate the parameter 
				    set.<h:br></h:br><h:br></h:br>
                                For each key length supported, the evaluator shall have the <abbr linkend="TSF"/> generate 25
				    parameter sets and key pairs. The evaluator shall verify the correctness of the 
				    <abbr linkend="TSF"/>’s implementation by comparing values generated by the <abbr linkend="TSF"/> 
				    with those generated from a known good implementation. Verification shall also confirm 
				    <h:br></h:br><h:br></h:br>
                                <h:ul>
                                    <h:li>g != 0,1</h:li>
                                    <h:li>q divides p-1</h:li>
                                    <h:li>g^q mod p = 1</h:li>
                                    <h:li>g^x mod p = y</h:li>
                                </h:ul>
                                for each FFC parameter set and key pair.
                            </Tests>
                        </aactivity>
                    </f-element>
		    <audit-event>
                        <table known="mandatory"/>
			<description>None.</description>
                        <add-info>None.</add-info>
		    </audit-event>
                </f-component>
            </subsection>

            <subsection id="fdp" title="User Data Protection">

                <!-- FDP_RIP_EXT.1 -->
                <f-component id="fdp_rip_ext.1" name="Residual Information in Memory">
                    <f-element>
                        <title>The <abbr linkend="TSF"/> shall ensure that any previous information content of physical memory is
				cleared prior to allocation to a Guest <abbr linkend="VM"/>.
                        </title>
                        <note role="application">Physical memory must be zeroed before it is made accessible to a <abbr linkend="VM"/>
				for general use by a Guest OS.<h:br></h:br><h:br></h:br>
                            The purpose of this requirement is to ensure that a <abbr linkend="VM"/> does not receive memory 
				containing data previously used by another <abbr linkend="VM"/> or the host.<h:br></h:br><h:br></h:br>
                            “For general use” means for use by the Guest OS in its page tables for running applications or system 
				software.<h:br></h:br><h:br></h:br>
                            This does not apply to pages shared by design or policy between <abbr linkend="VM"/>s or between the 
				<abbr linkend="VMM"/>s and <abbr linkend="VM"/>s, such as read-only OS pages or pages used for virtual
				device buffers.
                        </note>
                        <aactivity>
                            <TSS>
                                The evaluator shall ensure that the <abbr linkend="TSS"/> documents the process used for clearing
                                physical memory prior to allocation to a Guest <abbr linkend="VM"/>, providing details on when 
                                and how this is performed. Additionally, the evaluator shall ensure that the <abbr linkend="TSS"/>
                                documents the conditions under which physical memory is not cleared prior to allocation to a
                                Guest <abbr linkend="VM"/>, and describes when and how the memory is cleared.
                            </TSS>
                        </aactivity>
                    </f-element>
		    <audit-event>
                        <table known="mandatory"/>
			<description>None.</description>
                        <add-info>None.</add-info>
		    </audit-event>
                </f-component>
            </subsection>
            
            <subsection id="fia" title="Identification and Authentication">

                <!-- FIA_UAU.5 -->
                <f-component id="fia_uau.5" name="Multiple Authentication Mechanisms">
                    <f-element id="fil-aua">
                        <title>The <abbr linkend="TSF"/> shall provide the following authentication mechanisms:
                            <selectables linebreak="yes">
                                <selectable id="uau-pwd">
                                    <selectables>
                                        <selectable>local</selectable>
                                        <selectable>directory-based</selectable>
                                    </selectables>
                                    authentication based on username and password
                                </selectable>
                                <selectable>authentication based on username and a PIN that releases an asymmetric key stored in
					OE-protected storage</selectable>
                                <selectable id="uau-x509">
                                    <selectables>
                                        <selectable>local</selectable>
                                        <selectable>directory-based</selectable>
                                    </selectables>
                                    authentication based on X.509 certificates
                                </selectable>
                                <selectable id="uau-ssh">
                                    <selectables>
                                        <selectable>local</selectable>
                                        <selectable>directory-based</selectable>
                                    </selectables>
                                    authentication based on an SSH public key credential
                                </selectable>
                            </selectables>                            
                            to support Administrator authentication.
                        </title>
                        <note role="application">Selection of ‘authentication based on username and password’ requires that 
				FIA_PMG_EXT.1 be included in the <abbr linkend="ST"/>. This also requires that the 
				<abbr linkend="ST"/> include a management function for password management. If the 
				<abbr linkend="ST"/> author selects ‘authentication based on an SSH public-key credential’, the
				<abbr linkend="TSF"/> shall be validated against the Extended Package for Secure Shell.
				<h:br></h:br><h:br></h:br>
                            PINs used to access OE-protected storage are set and managed by the OE-protected storage mechanism. 
				Thus requirements on PIN management are outside the scope of the <abbr linkend="TOE"/>.
                        </note>
                    </f-element>
                    <f-element>
                        <title>The <abbr linkend="TSF"/> shall authenticate any Administrator’s claimed identity according to the 
				<assignable>rules describing how the multiple authentication mechanisms provide authentication
				</assignable>.
                        </title>
                        <aactivity>
                            <Tests>
                                If ‘username and password authentication‘ is selected, the evaluator will configure the TOE with a
				    known username and password and conduct the following tests:
                            <testlist>
                                <test>The evaluator will attempt to authenticate to the TOE using the known username and password. The
					evaluator will ensure that the authentication attempt is successful.</test>
                                <test>The evaluator will attempt to authenticate to the TOE using the known username but an incorrect 
					password. The evaluator will ensure that the authentication attempt is unsuccessful.</test>
                            </testlist>
                            If ‘username and PIN that releases an asymmetric key‘ is selected, the evaluator will examine the 
				    <abbr linkend="TSS"/> for guidance on supported protected storage and will then configure the
				    <abbr linkend="TOE"/> or OE to establish a PIN which enables release of the asymmetric key from
				    the protected storage (such as a TPM, a hardware token, or isolated execution environment) with 
				    which the TOE can interface. The evaluator will then conduct the following tests:
                            <testlist>
                                <test>The evaluator will attempt to authenticate to the TOE using the known user name and PIN. The
					evaluator will ensure that the authentication attempt is successful.</test>
                                <test>The evaluator will attempt to authenticate to the TOE using the known user name but an incorrect
					PIN. The evaluator will ensure that the authentication attempt is unsuccessful.</test>
                            </testlist>
                            If ‘X.509 certificate authentication‘ is selected, the evaluator will generate an X.509v3 certificate for
				    an Administrator user with the Client Authentication Enhanced Key Usage field set. The evaluator
				    will provision the TOE for authentication with the X.509v3 certificate. The evaluator will ensure
				    that the certificates are validated by the TOE as per FIA_X509_EXT.1.1 and then conduct the
				    following tests:
                            <testlist>
                                <test>The evaluator will attempt to authenticate to the TOE using the X.509v3 certificate. The 
					evaluator will ensure that the authentication attempt is successful.</test>
                                <test>The evaluator will generate a second certificate identical to the first except for the public
					key and any values derived from the public key. The evaluator will attempt to authenticate to
					the TOE with this certificate. The evaluator will ensure that the authentication attempt is
					unsuccessful.</test>
                            </testlist>
                            If ‘SSH public-key credential authentication‘ is selected, the evaluator shall generate a public-private
				    host key pair on the <abbr linkend="TOE"/> using RSA or ECDSA, and a second public-private key
				    pair on a remote client. The evaluator shall provision the TOE with the client public key for
				    authentication over SSH, and conduct the following tests:
                            <testlist>
                                <test>The evaluator will attempt to authenticate to the TOE using a message signed by the client
					private key that corresponds to provisioned client public key. The evaluator will ensure that
					the authentication attempt is successful.</test>
                                <test>The evaluator will generate a second client key pair and will attempt to authenticate to the TOE
					with the private key over SSH without first provisioning the TOE to support the new key pair.
					The evaluator will ensure that the authentication attempt is unsuccessful.</test>
                            </testlist>
                            </Tests>
                        </aactivity>
                    </f-element>
		    <audit-event>
                        <table known="mandatory"/>
			<description>None.</description>
                        <add-info>None.</add-info>
		    </audit-event>
                </f-component>
            </subsection>

            <subsection id="fmt" title="Security Management">
                
                <!-- FMT_SMO_EXT.1 -->
                <f-component id="fmt_smo_ext.1" name="Separation of Management and Operational Networks">
                    <f-element>
                        <title>The <abbr linkend="TSF"/> shall support the configuration of separate management and operational
				networks through
                            <selectables>
                                <selectable>physical means</selectable>
                                <selectable>logical means</selectable>
                                <selectable>trusted channel</selectable>
                            </selectables>.
                        </title>
                    </f-element>
                    <f-element>
                        <title>
                        </title>
                        <note role="application">Management communications must be separate from user workloads. Administrative 
				communications—including communications between physical hosts concerning load balancing, audit data,
				<abbr linkend="VM"/> startup and shutdown—must be separate from guest operational networks.
				<h:br></h:br><h:br></h:br>
                            “Physical means” refers to using separate physical networks for management and operational networks. For
				example, the machines in the management network are connected by separate cables plugged into separate
				and dedicated physical ports on each physical host.<h:br></h:br><h:br></h:br>
                            “Logical means” refers to using separate network cables to connect physical hosts together using 
				general-purpose networking ports. The management and operational networks are kept separate within 
				the hosts using separate virtualized networking components.<h:br></h:br><h:br></h:br>
                            If the <abbr linkend="ST"/> author selects “trusted channel”, then the protocols used for network 
				separation must be selected in FTP_ITC_EXT.1.
                        </note>
                        <aactivity>
                            <TSS>
                                The evaluator shall examine the <abbr linkend="TSS"/> to verify that it describes how management and
                                operational networks may be separated.
                            </TSS>
                            <Guidance>
                                The evaluator shall examine the operational guidance to verify that it details how to configure the 
                                TOE with separate Management and Operational Networks.
                            </Guidance>
                            <Tests>
                                The evaluator shall configure the management network as documented. If separation is cryptographic or 
                                logical, then the evaluator shall capture packets on the management network. If Guest network traffic 
                                is detected, the requirement is not met.
                            </Tests>
                        </aactivity>
                    </f-element>
		    <audit-event>
                        <table known="mandatory"/>
			<description>None.</description>
                        <add-info>None.</add-info>
		    </audit-event>
                </f-component>
            </subsection>
            
            <subsection id="fpt" title="Protection of the TSF">
 
                <!-- FPT_HAS_EXT.1 -->
                <f-component id="fpt_has_ext.1" name="Hardware Assists">
                    <f-element>
                        <title>The <abbr linkend="VMM"/> shall use <assignable>list of hardware-based virtualization assists
				</assignable> to reduce or eliminate the need for binary translation.
                        </title>
                    </f-element>
                    <f-element>
                        <title>The <abbr linkend="VMM"/> shall use <assignable>list of hardware-based virtualization memory-handling
				assists</assignable> to reduce or eliminate the need for shadow page tables.
                        </title>
                        <note role="application">These hardware-assists help reduce the size and complexity of the 
				<abbr linkend="VMM"/>, and thus, of the trusted computing base, by eliminating or reducing the need 
				for paravirtualization or binary translation. Paravirtualization involves modifying guest software so 
				that instructions that cannot be properly virtualized are never executed on the physical processor.
				<h:br></h:br><h:br></h:br>
                            For the assignment in FPT_HAS_EXT.1, the <abbr linkend="ST"/> author lists the hardware-based 
				virtualization assists on all platforms included in the <abbr linkend="ST"/> that are used by the 
				<abbr linkend="VMM"/> to reduce or eliminate the need for software-based binary translation. Examples
				for the x86 platform are Intel VT-x and AMD-V. “None” is an acceptable assignment for platforms that
				do not require virtualization assists in order to eliminate the need for binary translation. This must 
				be documented in the <abbr linkend="TSS"/>.<h:br></h:br><h:br></h:br>
                            For the assignment in FPT_HAS_EXT.1.2, the <abbr linkend="ST"/> author lists the set of hardware-based
				virtualization memory-handling extensions for all platforms listed in the <abbr linkend="ST"/> that
				are used by the <abbr linkend="VMM"/> to reduce or eliminate the need for shadow page tables. Examples 
				for the x86 platform are Intel EPT and AMD RVI. “None” is an acceptable assignment for platforms that
				do not require memory-handling assists in order to eliminate the need for shadow page tables. This
				must be documented in the <abbr linkend="TSS"/>.
                        </note>
                        <aactivity>
                            <TSS>
                                The evaluator shall examine the <abbr linkend="TSS"/> to ensure that it states, for each platform
                                listed in the <abbr linkend="ST"/>, the hardware assists and memory-handling extensions used by the
                                <abbr linkend="TOE"/> on that platform. The evaluator shall ensure that these lists correspond to what 
                                is specified in the applicable FPT_HAS_EXT component.
                            </TSS>
                        </aactivity>
                    </f-element>
		    <audit-event>
                        <table known="mandatory"/>
			<description>None.</description>
                        <add-info>None.</add-info>
		    </audit-event>
                </f-component>

                 <!-- FPT_ML_EXT.1 -->
                <f-component id="fpt_ml_ext.1" name="Measured Launch of Platform and VMM"  status="objective">
                    <f-element>
                        <title>The <abbr linkend="TSF"/> shall support a measured launch of the Virtualization System. Measured components
				of the Virtualization system shall include the static executable image of the Hypervisor and:
                            <selectables linebreak="yes">
                                <selectable>Static executable images of the Management Subsystem</selectable>
                                <selectable><assignable>list of (static images of) Service <abbr linkend="VM"/>s</assignable></selectable>
                                <selectable><assignable>list of configuration files</assignable></selectable>
                                <selectable>no other components</selectable>
                            </selectables>
                        </title>
                    </f-element>
                    <f-element>
                        <title>The <abbr linkend="TSF"/> shall make these measurements available to the Management Subsystem.
                        </title>
                        <note role="application">
                            A measured launch of the platform and Virtualization System, demonstrates that the proper 
				<abbr linkend="TOE"/> software was loaded. A measured launch process employs verifiable integrity 
				measurement mechanisms. For example, a TOE may hash components such as: the hypervisor, service
				<abbr linkend="VM"/>s and/or the Management Subsystem. A measured launch process only allows components
				to be executed after the measurement has been recorded. An example process may add each component’s 
				hash before it is executed so that the final hash reflects the evidence of a component’s state prior 
				to execution. The measurement may be verified as the system boots, but this is not required.<h:br></h:br><h:br></h:br>
                            The Platform is outside of the <abbr linkend="TOE"/>. However, this requirement specifies that the TOE must
				be capable of receiving Platform measurements if the Platform provides them. This requirement is 
				requiring <abbr linkend="TOE"/> support for Platform measurements if provided; it is not placing a
				requirement on the Platform to take such measurements.<h:br></h:br><h:br></h:br>
                            If available, hardware should be used to store measurements in such a manner that they cannot be modified
				in any manner except to be extended. These measurements should be produced in a repeatable manner so
				that a third party can verify the measurements if given the inputs. Hardware devices, like Trusted
				Platform Modules (TPM), TrustZone, and MMU are some examples that may serve as foundations for storing
				and reporting measurements.<h:br></h:br><h:br></h:br>
                            Platforms with a root of trust for measurement (RTM) should initiate the measured launch process. This may
				include core BIOS or the chipset. The chipset is the preferred RTM, but core BIOS or other firmware is
				acceptable. In system without a traditional RTM, the first component that boots would be considered
				the RTM, this is not preferred.
                        </note>
                        <aactivity>
                            <TSS>
                                The evaluator shall verify that the <abbr linkend="TSS"/> or Operational Guidance describes how 
                                integrity measurements are performed and made available to the Management Subsystem. The evaluator 
                                shall examine the operational guidance to verify that it documents how to access the measurements in 
                                the Management Subsystem.
                            </TSS>
                            <Tests>
                                The evaluator shall perform the following tests:<h:br></h:br><h:br></h:br>
                                <testlist>
                                    <test>The evaluator shall start the TOE, login as an Administrator, and verify that the
					    measurements for the specified components are viewable in the Management Subsystem.</test>
                              </testlist>
                            </Tests>
                        </aactivity>
                    </f-element>
		    <audit-event>
                        <table known="objective"/>
			<description>Integrity initiated/enabled.</description>
                        <add-info>Integrity measurement values.</add-info>
		    </audit-event>
                </f-component>
            </subsection>

            <subsection id="fta" title="TOE Access">
                <!-- FTA_TAB.1 -->
                <f-component id="fta_tab.1" name="TOE Access Banner">
                    <f-element>
                        <title>Before establishing an administrative user session, the <abbr linkend="TSF"/> shall display a
                            security Administrator-specifiedad advisory notice and consent warning message regarding
                            use of the <abbr linkend="TOE"/>.
                        </title>
                        <note role="application">
                            This requirement is intended to apply to interactive sessions between a human user and a TOE. IT
                            entities establishing connections or programmatic connections (e.g., remote procedure calls over
                            a network) are not required to be covered by this requirement.<h:br></h:br><h:br></h:br>
                        </note>
                        <aactivity>
                            <Tests>
                                The evaluator shall configure the <abbr linkend="TOE"/> to display the advisory warning message 
                                “TEST TEST Warning Message TEST TEST”. The evaluator shall then log out and confirm that the advisory 
                                message is displayed before logging can occur.
                            </Tests>
                        </aactivity>
                    </f-element>
                    <audit-event>
                                <table known="mandatory"/>
                                <description>None.</description>
                                <add-info>None.</add-info>
                    </audit-event>
                </f-component>
            </subsection>
          </section>

	<!-- Security Assurance Requirements -->
        <section id="sar" title="TOE Security Assurance Requirements">
            The Security Objectives for the <abbr linkend="TOE"/> in Section 4 were constructed to address threats identified in
		Section 3.1. The Security Functional Requirements (SFRs) in Section 5.1 are a formal instantiation of the Security
		Objectives. The PP identifies the Security Assurance Requirements (SARs) to frame the extent to which the evaluator
		assesses the documentation applicable for the evaluation and performs independent testing.<h:br></h:br><h:br></h:br>
            This section lists the set of Security Assurance Requirements (SARs) from Part 3 of the Common Criteria for Information 
		Technology Security Evaluation, Version 3.1, Revision 4 that are required in evaluations against this PP. Individual
		assurance activities to be performed are specified in both Section 5.1 as well as in this section.
		<h:br></h:br><h:br></h:br>
            After the <abbr linkend="ST"/> has been approved for evaluation, the Information Technology Security Evaluation Facility
		(ITSEF) will obtain the <abbr linkend="TOE"/>, supporting environmental IT, and the administrative/user guides for
		the <abbr linkend="TOE"/>. The ITSEF is expected to perform actions mandated by the <abbr linkend="CEM"/> for the ASE
		and ALC SARs. The ITSEF also performs the assurance activities contained within Section 5, which are intended to be an
		interpretation of the other <abbr linkend="CEM"/> assurance requirements as they apply to the specific technology
		instantiated in the <abbr linkend="TOE"/>. The assurance activities that are captured in Section 5 also provide
		clarification as to what the developer needs to provide to demonstrate the <abbr linkend="TOE"/> is compliant with
		the PP.
            <subsection id="ase" title="Class ASE: Security Target Evaluation">
                As per ASE activities defined in [<abbr linkend="CEM"/>] plus the <abbr linkend="TSS"/> assurance activities defined
		    for any SFRs claimed by the <abbr linkend="TOE"/>.
            </subsection>
            <subsection id="adv" title="Class ADV: Development">
                The information about the <abbr linkend="TOE"/> is contained in the guidance documentation available to the end user
		    as well as the <abbr linkend="TOE"/> Summary Specification (<abbr linkend="TSS"/>) portion of the 
		    <abbr linkend="ST"/>. The <abbr linkend="TOE"/> developer must concur with the description of the product that
		    is contained in the <abbr linkend="TSS"/> as it relates to the functional requirements. The Assurance Activities
		    contained in Section 5.2 should provide the <abbr linkend="ST"/> authors with sufficient information to determine
		    the appropriate content for the <abbr linkend="TSS"/> section.

                <!-- ADV_FSP.1 -->
                <a-component id="ADV_FSP.1" name="Basic functional specification">
	                <a-element type="D">
                        <title>The developer shall provide a functional specification.</title>
                    </a-element>
                    <a-element type="D">
                        <title>The developer shall provide a tracing from the functional specification to the SFRs.</title>
                        <note role="developer">
                            As indicated in the introduction to this section, the functional specification is composed of the
				information contained in the AGD_OPR and AGD_PRE documentation, coupled with the information provided
				in the <abbr linkend="TSS"/> of the <abbr linkend="ST"/>. The assurance activities in the functional
				requirements point to evidence that should exist in the documentation and <abbr linkend="TSS"/>
				section; since these are directly associated with the SFRs, the tracing in element ADV_FSP.1.2D is
				implicitly already done and no additional documentation is necessary.</note>
                    </a-element>
                	
                    <a-element type="C">
                        <title>The functional specification shall describe the purpose and method of use for each SFR-enforcing 
				and SFR-supporting TSFI.</title>
                    </a-element>
                    <a-element type="C">
                        <title>The functional specification shall identify all parameters associated with each SFR-enforcing and 
				SFR-supporting TSFI.</title>
                    </a-element>
                    <a-element type="C">
                        <title>The functional specification shall provide rationale for the implicit categorization of interfaces 
				as SFR-non-interfering.</title>
                    </a-element>
                    <a-element type="C">
                        <title>The tracing shall demonstrate that the SFRs trace to TSFIs in the functional specification.</title>
                    </a-element>
                  	
                    <a-element type="E">
                        <title>The evaluator shall confirm that the information provided meets all requirements for content and
				presentation of evidence.</title>
                    </a-element>
                    <a-element type="E">
                        <title>The evaluator shall determine that the functional specification is an accurate and complete 
				instantiation of the SFRs.</title>
                        <note role="application">
                            There are no specific assurance activities associated with these SARs. The functional specification 
				documentation is provided to support the evaluation activities described in Section 5.2, and other
				activities described for AGD, ATE, and AVA SARs. The requirements on the content of the functional 
				specification information is implicitly assessed by virtue of the other assurance activities being
				performed; if the evaluator is unable to perform an activity because the there is insufficient
				interface information, then an adequate functional specification has not been provided.
                        </note>
                    </a-element>
                </a-component>
            </subsection>

            <subsection id="agd" title="Class AGD: Guidance Documents">
                The guidance documents will be provided with the developer’s security target. Guidance must include a description
		    of how the authorized user verifies that the Operational Environment can fulfill its role for the security
		    functionality. The documentation should be in an informal style and readable by an authorized user.
		    <h:br></h:br><h:br></h:br>
                Guidance must be provided for every operational environment that the product supports as claimed in the 
		    <abbr linkend="ST"/>. This guidance includes
                <h:ul>
                    <h:li>instructions to successfully install the <abbr linkend="TOE"/> in that environment; and</h:li>
                    <h:li>instructions to manage the security of the <abbr linkend="TOE"/> as a product and as a component of the 
			    larger operational environment.</h:li>
                </h:ul>
                Guidance pertaining to particular security functionality is also provided; specific requirements on such guidance are
		    contained in the assurance activities specified with individual SFRs where applicable.
                
		<!-- AGD_OPE.1 -->
		<a-component id="AGD_OPE.1" name="Operational User Guidance">
	                
                    <a-element type="D">
                        <title>The developer shall provide operational user guidance.
                        </title>
                        <note role="developer">
                            Rather than repeat information here, the developer should review the assurance activities for this
				component to ascertain the specifics of the guidance that the evaluators will be checking for. 
				This will provide the necessary information for the preparation of acceptable guidance.</note>
                    </a-element>
                    
                    <a-element type="C">
                        <title>The operational user guidance shall describe what the authorized user-accessible functions and
				privileges that should be controlled in a secure processing environment, including appropriate 
				warnings.</title>
                    </a-element>
                    <a-element type="C">
                        <title>The operational user guidance shall describe, for the authorized user, how to use the available
				interfaces provided by the <abbr linkend="TOE"/> in a secure manner.</title>
                    </a-element>
                    <a-element type="C">
                        <title>The operational user guidance shall describe, for the authorized user, the available functions and
				interfaces, in particular all security parameters under the control of the user, indicating secure
				values as appropriate.</title>
                    </a-element>
                    <a-element type="C">
                        <title>The operational user guidance shall, for the authorized user, clearly present each type of 
				security-relevant event relative to the user-accessible functions that need to be performed, including
				changing the security characteristics of entities under the control of the <abbr linkend="TSF"/>.</title>
                    </a-element>
                    <a-element type="C">
                        <title>The operational user guidance shall identify all possible modes of operation of the
				<abbr linkend="TOE"/> (including operation following failure or operational error), their consequences
				and implications for maintaining secure operation.</title>
                    </a-element>
                    <a-element type="C">
                        <title>The operational user guidance shall, for the authorized user, describe the security measures to be
				followed in order to fulfill the security objectives for the operational environment as described in
				the <abbr linkend="ST"/>.</title>
                    </a-element>
                    <a-element type="C">
                        <title>The operational user guidance shall be clear and reasonable.</title>
                    </a-element>
                  	
                    <a-element type="E">
                        <title>The evaluator shall confirm that the information provided meets all requirements for content and
				presentation of evidence.</title>
                        <aactivity>
                            <Guidance>
                                Some of the contents of the operational guidance will be verified by the assurance activities in 
                                Section 5.2 and evaluation of the <abbr linkend="TOE"/> according to the <abbr linkend="CEM"/>. The 
                                following additional information is also required.<h:br></h:br><h:br></h:br>
                                The operational guidance shall contain instructions for configuring the password characteristics,
                                number of allowed authentication attempt failures, the lockout period times for inactivity, and the
                                notice and consent warning that is to be provided when authenticating.<h:br></h:br><h:br></h:br>
                                The operational guidance shall contain step-by-step instructions suitable for use by an end-user
                                of the Virtualization System to configure a new, out-of-the-box system into the configuration
                                evaluated under this Protection Profile.<h:br></h:br><h:br></h:br>
                                The documentation shall describe the process for verifying updates to the <abbr linkend="TOE"/>, 
                                either by checking the hash or by verifying a digital signature. The evaluator shall verify that 
                                this process includes the following steps:
                                <h:ul>
                                    <h:li>Instructions for querying the current version of the <abbr linkend="TOE"/> software.</h:li>
                                    <h:li>For hashes, a description of where the hash for a given update can be obtained. For digital
					    signatures, instructions for obtaining the certificate that will be used by the 
					    FCS_COP.1(2) mechanism to ensure that a signed update has been received from the 
					    certificate owner. This may be supplied with the product initially, or may be obtained by
					    some other means.</h:li>
                                    <h:li>Instructions for obtaining the update itself. This should include instructions for making 
					    the update accessible to the <abbr linkend="TOE"/> (e.g., placement in a specific 
					    directory).</h:li>
                                    <h:li>Instructions for initiating the update process, as well as discerning whether the process
					    was successful or unsuccessful. This includes generation of the hash/digital signature.</h:li>
                              </h:ul>
                            </Guidance>
                        </aactivity>
                    </a-element>
                </a-component>

		<!-- AGD_PRE.1 -->
                <a-component id="AGD_PRE.1" name="Preparative procedures">
                	
                    <a-element type="D">
                        <title>The developer shall provide the <abbr linkend="TOE"/> including its preparative procedures.
                        </title>
                        <note role="developer">As with the operational guidance, the developer should look to the assurance
				activities to determine the required content with respect to preparative procedures.
                        </note>
                    </a-element>
                    
                    <a-element type="C">
                        <title>The preparative procedures shall describe all the steps necessary for secure acceptance of the
				delivered <abbr linkend="TOE"/> in accordance with the developer’s delivery procedures.</title>
                    </a-element>
                    <a-element type="C">
                        <title>The preparative procedures shall describe all the steps necessary for secure installation of the 
				<abbr linkend="TOE"/> and for the secure preparation of the operational environment in accordance 
				with the security objectives for the operational environment as described in the <abbr linkend="ST"/>.
			    </title>
                    </a-element>
                   	
                    <a-element  type="E">
                        <title>The evaluator shall confirm that the information provided meets all requirements for content and 
				presentation of evidence.</title>
                    </a-element>
                    <a-element type="E">
                        <title>The evaluator shall apply the preparative procedures to confirm that the <abbr linkend="TOE"/> can be
				prepared securely for operation.</title>
                        <aactivity>
                            <Guidance>
                                As indicated in the introduction above, there are significant expectations with respect to the
                                documentation—especially when configuring the operational environment to support <abbr linkend="TOE"/>
                                functional requirements. The evaluator shall check to ensure that the guidance provided for the 
                                <abbr linkend="TOE"/> adequately addresses all platforms (that is, combination of hardware and 
                                operating system) claimed for the <abbr linkend="TOE"/> in the <abbr linkend="ST"/>.<h:br></h:br><h:br></h:br>
                                The operational guidance shall contain step-by-step instructions suitable for use by an end-user of
                                the Virtualization System to configure a new, out-of-the-box system into the configuration evaluated 
                                under this Protection Profile.
                            </Guidance>
                        </aactivity>
                    </a-element>
                </a-component>
            </subsection>

            <subsection id="alc" title="Class ALC: Life-Cycle Support">
                At the assurance level specified for <abbr linkend="TOE"/>s conformant to this PP, life-cycle support is limited to 
		    an examination of the <abbr linkend="TOE"/> vendor’s development and configuration management process in order to
		    provide a baseline level of assurance that the <abbr linkend="TOE"/> itself is developed in a secure manner and
		    that the developer has a well-defined process in place to deliver updates to mitigate known security flaws. This
		    is a result of the critical role that a developer’s practices play in contributing to the overall trustworthiness
		    of a product.

		<!-- ALC_CMC.1 -->
		<a-component id="ALC_CMC.1" name="Labeling of the TOE">
                    
                    <a-element type="D">
                        <title>The developer shall provide the <abbr linkend="TOE"/> and a reference for the <abbr linkend="TOE"/>.
                        </title>
                    </a-element>
                    
                    <a-element type="C">
                        <title>The <abbr linkend="TOE"/> shall be labeled with its unique reference.
                        </title>
                    </a-element>
                    
                    <a-element type="E">
                        <title>The evaluator shall confirm that the information provided meets all requirements for content and 
				presentation of evidence.
                        </title>
                        <aactivity>
                            <TSS>
                                The evaluator shall check the ST to ensure that it contains an identifier (such as a product
                                name/version number) that specifically identifies the version that meets the requirements of the ST.
                            </TSS>
                            <Guidance>
                                The evaluator shall check the AGD guidance and TOE samples received for testing to ensure
                                that the version number is consistent with that in the ST. 
                            </Guidance>
                            <Tests>
                                If the vendor maintains a web site
                                advertising the TOE, the evaluator shall examine the information on the web site to ensure that
                                the information in the ST is sufficient to distinguish the product.
                            </Tests>
                        </aactivity>
                    </a-element>
                </a-component>

		<!-- ALC_CMS.1 -->
		<a-component id="ALC_CMS.1" name="TOE CM coverage">
                    
                    <a-element type="D">
                        <title>The developer shall provide a configuration list for the <abbr linkend="TOE"/>.
                        </title>
                    </a-element>
  	                
                    <a-element type="C">
                        <title>The configuration list shall include the following: the <abbr linkend="TOE"/> itself; and the
                            evaluation evidence required by the SARs.
                        </title>
                    </a-element>
                    <a-element type="C">
                        <title>The configuration list shall uniquely identify the configuration items.
                        </title>
                    </a-element>
                    
                    <a-element type="E">
                        <title>The evaluator shall confirm that the information provided meets all requirements for content and
				presentation of evidence.</title>
                        <aactivity>
                            <Guidance>
                                The evaluator shall ensure that the developer has identified (in public-facing development
                                guidance for their platform) one or more development environments appropriate for use in developing
                                applications for the developer’s platform. For each of these development environments, the developer
                                shall provide information on how to configure the environment to ensure that buffer overflow protection
                                mechanisms in the environment(s) are invoked (e.g., compiler and linker flags). The evaluator shall
                                ensure that this documentation also includes an indication of whether such protections are on by
                                default, or have to be specifically enabled.
                                The evaluator shall ensure that the TSF is uniquely identified (with respect to other products from
                                the TSF vendor), and that documentation provided by the developer in association with the requirements
                                in the ST is associated with the TSF  using this unique identification.
                            </Guidance>
                        </aactivity>
                    </a-element>
                </a-component>

		<!-- ALC_TSU_EXT -->
                <a-component id="ALC_TSU_EXT.1" name="Timely Security Updates">
                    This component requires the <abbr linkend="TOE"/> developer, in conjunction with any other necessary parties, to
			provide information as to how the Virtualization System is updated to address security issues in a timely 
			manner. The documentation describes the process of providing updates to the public from the time a security
			flaw is reported/discovered, to the time an update is released. This description includes the parties involved 
			(e.g., the developer, hardware vendors) and the steps that are performed (e.g., developer testing), including
			worst case time periods, before an update is made available to the public.
                    
                    <a-element type="D">
                        <title>The developer shall provide a description in the <abbr linkend="TSS"/> of how timely security updates
				are made to the <abbr linkend="TOE"/>.</title>
                    </a-element>
                 	
                    <a-element type="C">
                        <title>The description shall include the process for creating and deploying security updates for the 
				<abbr linkend="TOE"/> software/firmware.</title>
                    </a-element>
                    <a-element type="C">
                        <title>The description shall express the time window as the length of time, in days, between public disclosure
				of a vulnerability and the public availability of security updates to the <abbr linkend="TOE"/>.</title>
                        <note role="application">
                            The total length of time may be presented as a summation of the periods of time that each party (e.g.,
				<abbr linkend="TOE"/> developer, hardware vendor) on the critical path consumes. The time period until
				public availability per deployment mechanism may differ; each is described.</note>
                    </a-element>
                    <a-element type="C">
                        <title>The description shall include the mechanisms publicly available for reporting security issues
				pertaining to the <abbr linkend="TOE"/>.</title>
                        <note role="application">
                            The reporting mechanism could include web sites, email addresses, and a means to protect the sensitive
				nature of the report (e.g., public keys that could be used to encrypt the details of a proof-of-concept
				exploit).</note>
                    </a-element>
                    
                    <a-element type="E">
                        <title>The evaluator shall confirm that the information provided meets all requirements for content and 
				presentation of evidence.</title>
                    </a-element>
                </a-component>

            </subsection>
            <subsection id="ate" title="Class ATE: Tests">
                Testing is specified for functional aspects of the system as well as aspects that take advantage of design or
		    implementation weaknesses. The former is done through ATE_IND family, while the latter is through the AVA_VAN
		    family. At the assurance level specified in this PP, testing is based on advertised functionality and interfaces
		    with dependency on the availability of design information. One of the primary outputs of the evaluation process is 
		    the test report as specified in the following requirements.

		<!-- ATE_IND.1 -->
	 	<a-component id="ATE_IND.1" name="Independent Testing - Sample">
                    Testing is performed to confirm the functionality described in the <abbr linkend="TSS"/> as well as the
			administrative (including configuration and operation) documentation provided. The focus of the testing is to
			confirm that the requirements specified in Section 5.1 are being met, although some additional testing is
			specified for SARs in Section 5.2. The Assurance Activities identify the additional testing activities
			associated with these components. The evaluator produces a test report documenting the plan for and results
			of testing, as well as coverage arguments focused on the platform/<abbr linkend="TOE"/> combinations that are
			claiming conformance to this PP.
            	    
                    <a-element type="D">
                        <title>The developer shall provide the <abbr linkend="TOE"/> for testing.
                        </title>
                    </a-element>
                    
                    <a-element type="C">
                        <title>The <abbr linkend="TOE"/> shall be suitable for testing.
                        </title>
                    </a-element>
                    
                    <a-element type="E">
                        <title>The evaluator shall confirm that the information provided meets all requirements for content and 
				presentation of evidence.</title>
                    </a-element>
                    <a-element type="E">
                        <title>The evaluator shall test a subset of the <abbr linkend="TSF"/> to confirm that the <abbr linkend="TSF"/> 
				operates as specified.
                        </title>
                        <aactivity>
                            <Tests>
                                The evaluator shall prepare a test plan and report documenting the testing aspects of the system. 
				    While it is not necessary to have one test case per test listed in an Assurance Activity, the 
				    evaluators must document in the test plan that each applicable testing requirement in the 
				    <abbr linkend="ST"/> is covered.<h:br></h:br><h:br></h:br>
                                The Test Plan identifies the platforms to be tested, and for those platforms not included in the test 
				    plan but included in the <abbr linkend="ST"/>, the test plan provides a justification for not
				    testing the platforms. This justification must address the differences between the tested
				    platforms and the untested platforms, and make an argument that the differences do not affect the
				    testing to be performed. It is not sufficient to merely assert that the differences have no affect;
				    rationale must be provided. If all platforms claimed in the <abbr linkend="ST"/> are tested, then
				    no rationale is necessary.<h:br></h:br><h:br></h:br>
                                The test plan describes the composition of each platform to be tested, and any setup that is necessary
				    beyond what is contained in the AGD documentation. It should be noted that the evaluators are
				    expected to follow the AGD documentation for installation and setup of each platform either as
				    part of a test or as a standard pre-test condition. This may include special test drivers or tools.
				    For each driver or tool, an argument (not just an assertion) is provided that the driver or tool 
				    will not adversely affect the performance of the functionality by the <abbr linkend="TOE"/> and
				    its platform. This also includes the configuration of cryptographic engines to be used. The 
				    cryptographic algorithms implemented by these engines are those specified by this PP and used by 
				    the cryptographic protocols being evaluated (IPsec, TLS/HTTPS, SSH).<h:br></h:br><h:br></h:br>
                                The test plan identifies high-level test objectives as well as the test procedures to be followed to
				    achieve those objectives. These procedures include expected results. The test report (which could
				    just be an annotated version of the test plan) details the activities that took place when the
				    test procedures were executed, and includes the actual results of the tests. This shall be a 
				    cumulative account, so if there was a test run that resulted in a failure; a fix installed; and
				    then a successful re-run of the test, the report would show a “fail” and “pass” result (and the
				    supporting details), and not just the “pass” result.
                            </Tests>
                         </aactivity>
                    </a-element>
                </a-component>
            </subsection>
            
            <subsection id="ava" title="Class AVA: Vulnerability Assessment">
                For the first generation of this Protection Profile, the evaluation lab is expected to survey open sources to learn
		    what vulnerabilities have been discovered in these types of products. In most cases, these vulnerabilities will
		    require sophistication beyond that of a basic attacker. Until penetration tools are created and uniformly 
		    distributed to the evaluation labs, evaluators will not be expected to test for these vulnerabilities in the 
		    <abbr linkend="TOE"/>. The labs will be expected to comment on the likelihood of these vulnerabilities given the
		    documentation provided by the vendor. This information will be used in the development of penetration testing 
		    tools and for the development of future PPs.

		<!-- AVA_VAN.1 -->
		<a-component id="AVA_VAN.1" name="Vulnerability survey">
            	    
                    <a-element type="D">
                        <title>The developer shall provide the <abbr linkend="TOE"/> for testing.
                        </title>
                    </a-element>
                   	
                    <a-element type="C">
                        <title>The <abbr linkend="TOE"/> shall be suitable for testing.
                        </title>
                    </a-element>
                    
                    <a-element type="E">
                        <title>The evaluator shall confirm that the information provided meets all requirements for content and
				presentation of evidence.</title>
                    </a-element>
                    <a-element type="E">
                        <title>The evaluator shall perform a search of public domain sources to identify potential vulnerabilities in
				the <abbr linkend="TOE"/>.</title>
                    </a-element>
                    <a-element type="E">
                        <title>The evaluator shall conduct penetration testing, based on the identified potential vulnerabilities, to
				determine that the <abbr linkend="TOE"/> is resistant to attacks performed by an attacker possessing
				Basic attack potential.</title>
                        <aactivity>As with ATE_IND the evaluator shall generate a report to document their findings with respect to
				this requirement. This report could physically be part of the overall test report mentioned in ATE_IND,
				or a separate document. The evaluator performs a search of public information to determine the
				vulnerabilities that have been found in virtualization in general, as well as those that pertain to
				the particular <abbr linkend="TOE"/>. The evaluator documents the sources consulted and the
				vulnerabilities found in the report. For each vulnerability found, the evaluator either provides a
				rationale with respect to its non-applicability or the evaluator formulates a test (using the
				guidelines provided in ATE_IND) to confirm the vulnerability, if suitable. Suitability is determined
				by assessing the attack vector needed to take advantage of the vulnerability. For example, if the
				vulnerability can be detected by pressing a key combination on boot-up, a test would be suitable at
				the assurance level of this PP. If exploiting the vulnerability requires expert skills and an electron
				microscope, for instance, then a test would not be suitable and an appropriate justification would be
				formulated.</aactivity>
                    </a-element>
                </a-component>
            </subsection>
        </section>
    </chapter>
    
    <!-- Annex A: OPTIONAL Requirements -->
    
    <appendix id="optional" title="Optional Requirements">
        <h:br></h:br><h:br></h:br>

        See <ctr-ref refid="audit-table">: Auditable Events</ctr-ref> for more information.<h:br/><h:br/>
        Depending on the specific requirements selected by the <abbr linkend="ST"/> author, the 
	    <abbr linkend="ST"/>/<abbr linkend="TOE"/> should include the appropriate auditable events from the table below in
	    the <abbr linkend="ST"/> as part of the FAU_GEN.1 claim.<h:br></h:br><h:br></h:br>
	    
        <audit-events table="optional"/><h:br/>
        <ctr id="audit-table" ctr-type="Table">: Auditable Events</ctr>
    </appendix>

    <!-- ANNEX B: Selection-Based -->
    <appendix id="sel-based" title="Selection-Based Requirements">
        
	<!-- Table 3 contains optional audit events within the selection-based requirements.
	     Table 4 contains audit events that are mandatory if the corresponding SFR is selected. 
	     Not sure yet how I'm going to deal with this. -->
	<h:b>FAU_GEN.1 Auditable Events Table (Optional)</h:b><h:br></h:br><h:br></h:br>
        The following additional auditable events may be claimed by the <abbr linkend="ST"/> author if “additional information
        defined in Table 3” is selected in FAU_GEN.1.  Any subset of Table 3, including individual entries, may be included in
        the <abbr linkend="ST"/>; it is not necessary to include the entirety of Table 3.<h:br></h:br><h:br></h:br>

        See <ctr-ref refid="audit-table">: Auditable Events</ctr-ref> for more information.<h:br/><h:br/>
	    
        <audit-events table="sel-based"/><h:br/>
        <ctr id="audit-table" ctr-type="Table">: Auditable Events</ctr>
	    
        <h:br></h:br><h:br></h:br>
        
    </appendix>

    <!-- Annex C: Objective Requirements -->
    <appendix id="objective" title="Objective Requirements">
      
        <h:b>Auditable Events</h:b>
        Depending on the specific objective SFRs that are claimed by the <abbr linkend="ST"/>/<abbr linkend="TOE"/>, the
	    <abbr linkend="ST"/> author shall
	include the appropriate auditable events listed below in the claims made for FAU_GEN.1.<h:br></h:br><h:br></h:br>

        See <ctr-ref refid="audit-table">: Auditable Events</ctr-ref> for more information.<h:br/><h:br/>
 
        <audit-events table="objective"/><h:br/>
        <ctr id="audit-table" ctr-type="Table">: Auditable Events</ctr>

	<h:br></h:br><h:br></h:br>
	    
    </appendix>

    <!-- Annex D: Entropy Documentation and Assessment -->
    <appendix id="ent" title="Entropy Documentation and Assessment">
        <section id="design" title="Design Description">
            Documentation shall include the design of the entropy source as a whole, including the interaction of all entropy source 
		components. It will describe the operation of the entropy source to include how it works, how entropy is produced, and
		how unprocessed (raw) data can be obtained from within the entropy source for testing purposes. The documentation 
		should walk through the entropy source design indicating where the random comes from, where it is passed next, any
		post-processing of the raw outputs (hash, XOR, etc.), if/where it is stored, and finally, how it is output from the 
		entropy source. Any conditions placed on the process (e.g., blocking) should also be described in the entropy source
		design. Diagrams and examples are encouraged.<h:br></h:br><h:br></h:br>
            This design must also include a description of the content of the security boundary of the entropy source and a 
		description of how the security boundary ensures that an adversary outside the boundary cannot affect the entropy 
		rate.
        </section>
        <section id="justification" title="Entropy Justification">
            There should be a technical argument for where the unpredictability in the source comes from and why there is confidence
		in the entropy source exhibiting probabilistic behavior (an explanation of the probability distribution and
		justification for that distribution given the particular source is one way to describe this). This argument will
		include a description of the expected entropy rate and explain how you ensure that sufficient entropy is going into
		the <abbr linkend="TOE"/> randomizer seeding process. This discussion will be part of a justification for why the
		entropy source can be relied upon to produce bits with entropy.
        </section>
        <section id="oc" title="Operating Conditions">
            Documentation will also include the range of operating conditions under which the entropy source is expected to generate 
		random data. It will clearly describe the measures that have been taken in the system design to ensure the entropy
		source continues to operate under those conditions. Similarly, documentation shall describe the conditions under which
		the entropy source is known to malfunction or become inconsistent. Methods used to detect failure or degradation of
		the source shall be included.
        </section>
        <section id="health" title="Health Testing">
            More specifically, all entropy source health tests and their rationale will be documented. This will include a description
		of the health tests, the rate and conditions under which each health test is performed (e.g., at startup, continuously,
		or on-demand), the expected results for each health test, and rationale indicating why each test is believed to be
		appropriate for detecting one or more failures in the entropy source.
        </section>
    </appendix>

    <!-- Annex E: Equivalency Cuidelines -->
    <appendix id="equiv" title="Equivalency Guidlines">
        <section id="gpcp-intro" title="Introduction">
          The purpose of equivalence in PP-based evaluations is to find a balance between evaluation rigor and commercial
            practicability--to ensure that evaluations meet customer expectations while recognizing that there is little to be gained
            from requiring that every variation in a product or platform be fully tested. If a product is found to be compliant with
            a PP on one platform, then all equivalent products on equivalent platforms are also considered to be compliant with the PP.
        <h:br />
        <h:br />
        A Vendor can make a claim of equivalence if the Vendor believes that a particular instance of their Product implements
            PP-specified security functionality in a way equivalent to the implementation of the same functionality on another
            instance of their Product on which the functionality was tested. The Product instances can differ in version number or
            feature level (model), or the instances may run on different platforms. Equivalency can be used to reduce the testing
            required across claimed evaluated configurations. It can also be used during Assurance Maintenance to reduce testing
            needed to add more evaluated configurations to a certification.
      <h:br />
      <h:br />
      These equivalency guidelines do not replace Assurance Maintenance requirements or NIAP Policy #5 requirements for CAVP
            certificates. Nor may equivalency be used to leverage evaluations with expired certifications.
      <h:br />
      <h:br />
      This document provides guidance for determining whether Products and Platforms are equivalent for purposes of
            evaluation against the Protection Profile for Virtualization (VPP) when instantiated with either the Client or Server
            Extended Package.
      <h:br />
      <h:br />
      Equivalence has two aspects:
      <h:br />
      <h:ol>
        <h:li><h:b><h:i>Product Equivalence:</h:i></h:b> Products may be considered equivalent if there are no
          differences between Product Models and Product Versions with respect to PP-specified security functionality.</h:li>
        <h:li><h:b><h:i>Platform Equivalence:</h:i></h:b> Platforms may be considered equivalent if there are no
          significant differences in the services they provide to the Product--or in the way the platforms
          provide those services--with respect to PP-specified security functionality.</h:li>
      </h:ol>
      The equivalency determination is made in accordance with these guidelines by the Validator and Scheme using information
            provided by the Evaluator/Vendor.
    </section>
    <section id="approach" title="Approach to Equivalency Analysis">
      There are two scenarios for performing equivalency analysis. One is when a product has been certified and the vendor
      wants to show that a later product should be considered certified due to equivalence with the earlier product. The
      other is when multiple product variants are going though evaluation together and the vendor would like to reduce
      the amount of testing that must be done. The basic rules for determining equivalence are the same in both cases.
      But there is one additional consideration that applies to equivalence with previously certified products. That is,
      the product with which equivalence is being claimed must have a valid certification in accordance with scheme rules
      and the Assurance Maintenance process must be followed. If a product’s certification has expired, then equivalence
      cannot be claimed with that product.
      <h:br /><h:br />
      When performing equivalency analysis, the Evaluator/Vendor should first use the factors and guidelines for Product
      Model equivalence to determine the set of Product Models to be evaluated. In general, Product Models that do not differ
      in PP-specified security functionality are considered equivalent for purposes of evaluation against the VPP.
      <h:br /><h:br />
      If multiple revision levels of Product Models are to be evaluated--or to determine whether a revision of an evaluated
      product needs re-evaluation--the Evaluator/Vendor and Validator should use the factors and guidelines for Product
      Version equivalence to determine whether Product Versions are equivalent.
      <h:br /><h:br />
      Having determined the set of Product Models and Versions to be evaluated, the next step is to determine the set of
      Platforms that the Products must be tested on.
      <h:br /><h:br />
      Each non-equivalent Product for which compliance is claimed must be fully tested on each non-equivalent platform
      for which compliance is claimed. For non-equivalent Products on equivalent platforms, only the differences that
      affect PP-specified security functionality must be tested for each product.
      <h:br />
      <h:br />
      If the set of equivalent Products includes only bare-metal installations, then the equivalency analysis is complete.
        But if any members of the set include hosted installations or installations that integrate with an existing host operating
        system or control domain, then software platform equivalence must be taken into consideration. The Evaluator/Vendor and
        Validator should use the factors and guidance for software platform equivalence to determine whether different models or
        versions of host or control domain operating systems require separate testing.
      <h:b><h:i>“Differences in PP-Specified Security Functionality” Defined</h:i></h:b>
      <h:br />
      If PP-specified security functionality is implemented by the TOE, then differences in the actual implementation
      between versions or product models break equivalence for that feature. Likewise, if the TOE implements the
      functionality in one version or model and the functionality is implemented by the platform in another version
      or model, then equivalence is broken. If the functionality is implemented by the platform in multiple models or
      versions on equivalent platforms, then the functionality is considered different if the product invokes the platform
      differently to perform the function.
    </section>
    <section id="modelequiv" title="Specific Guidance for Determining Product Model Equivalence">
      Product Model equivalence attempts to determine whether different feature levels of the same product across
      a product line are equivalent for purposes of PP testing. For example, if a product has a “basic” edition and an “enterprise”
      edition, is it necessary to test both models? Or does testing one model provide sufficient assurance that both models
      are compliant?
      <h:br />
      <h:br />
      Table 1, below, lists the factors for determining Product Model equivalence.
      <h:br />
      <h:br />
      
      <h:table border="1">
        <h:tr class="header" bgcolor="#cccccc">
          <h:td valign="top">Factor</h:td>
          <h:td valign="top">Same/Different</h:td>
          <h:td valign="top">Guidance</h:td>
        </h:tr>
        <h:tr>
          <h:td valign="top">Target Platform</h:td>
          <h:td valign="top">Different</h:td>
          <h:td valign="top">Product Models that virtualize different instruction sets (e.g. x86, ARM, POWER, SPARC, MIPS)
              are not equivalent.</h:td>
        </h:tr>
        <h:tr>
          <h:td valign="top">Installation Types</h:td>
          <h:td valign="top">Different</h:td>
          <h:td valign="top">If a Product can be installed either on bare metal or onto an operating system (either Type 1 or Type
              2), and the vendor wants to claim that both installation types constitute a single Model, then see the guidance
              for “PP-Specified Functionality,” below.</h:td>
        </h:tr>
        <h:tr>
          <h:td valign="top">Software Platform</h:td>
          <h:td valign="top">Different</h:td>
          <h:td valign="top">Product Models that run on substantially different software environments, such as different host
              operating systems, are not equivalent. Models that install on different versions of the same software environment
              may be equivalent depending on the below factors.</h:td>
        </h:tr>
        <h:tr>
          <h:td rowspan="2" valign="top">PP-Specified Functionality</h:td>
          <h:td valign="top">Same</h:td>
          <h:td valign="top">If the differences between Models affect only non-PP-specified functionality, then the Models are
		  equivalent. </h:td>
        </h:tr>
        <h:tr>
          <h:td valign="top">Different</h:td>
          <h:td valign="top">If PP-specified security functionality is affected by the differences between Models,
            then the Models are not equivalent and must be tested separately. It is necessary to test only the functionality
            affected by the software differences. If only differences are tested, then the differences must be enumerated,
            and for each difference the Vendor must provide an explanation of why each difference does or does not affect
            PP-specified functionality. If the Product Models are fully tested separately, then there is no need to document the 
		  differences.
          </h:td>
        </h:tr>
      </h:table>
      <h:b>Table 1. Factors for Determining Product Model Equivalance</h:b>
      <h:br />
      <h:br />
    </section>
        
    <section id="versionequiv" title="Specific Guidance for Determining Product Version Equivalence">
      In cases of version equivalence, differences are expressed in terms of changes implemented in revisions
      of an evaluated Product. In general, versions are equivalent if the changes have no effect on any
      security-relevant claims about the TOE or assurance evidence. Non-security-relevant changes to TOE
      functionality or the addition of non-security-relevant functionality does not affect equivalence.
      <h:br /><h:br />
      
      <h:table border="1">
        <h:tr class="header" bgcolor="#cccccc">
          <h:td valign="top">Factor</h:td>
          <h:td valign="top">Same/Different</h:td>
          <h:td valign="top">Guidance</h:td>
        </h:tr>
        <h:tr valign="top">
          <h:td valign="top">Product Models</h:td>
          <h:td valign="top">Different</h:td>
          <h:td valign="top">Versions of different Product Models are not equivalent unless the Models are equivalent as defined in
		  Section 3.</h:td>
        </h:tr>
        <h:tr>
          <h:td rowspan="2" valign="top">PP-Specified Functionality</h:td>
          <h:td valign="top">Same</h:td>
          <h:td valign="top">If the differences affect only non-PP-specified functionality, then the Versions are equivalent. </h:td>
        </h:tr>
        <h:tr>
          <h:td valign="top">Different</h:td>
          <h:td valign="top">If PP-specified security functionality is affected by the differences, then the
            Versions are considered to be not equivalent and must be tested separately. It is necessary only to test
            the functionality affected by the changes. If only the differences are tested, then for each
            difference the Vendor must provide an explanation of why the difference does or does not affect
            PP-specified functionality. If the Product Versions are fully tested separately, then there is
            no need to document the differences. </h:td>
        </h:tr>
      </h:table>
      <h:b>Table 2. Factors for Determining Product Version Equivalence</h:b>
      <h:br />
      <h:br />
    </section>
    <section id="platformequiv" title="Specific Guidance for Determining Platform Equivalence">
      Platform equivalence is used to determine the platforms that a product must be tested on. These guidelines are divided
        into sections for determining hardware equivalence and software (host OS/control domain) equivalence. If the Product is
        installed onto bare metal, then only hardware equivalence is relevant. If the Product is installed onto an OS—or is integrated
        into an OS—then both hardware and software equivalence are required. Likewise, if the Product can be installed either on bare
        metal or on an operating system, both hardware and software equivalence are relevant.
      <h:br /><h:br />
      <subsection id="hardware-equiv" title="Hardware Platform Equivalence">
        If a Virtualization Solution runs directly on hardware without an operating system, then platform equivalence is based primarily
          on processor architecture and instruction sets.
        <h:br /><h:br />
        Platforms with different processor architectures and instruction sets are not equivalent. This is probably
          not an issue because there is likely to be a different product model for different hardware environments.
        <h:br /><h:br />
        Equivalency analysis becomes important when comparing platforms with the same processor architecture. Processors
          with the same architecture that have instruction sets that are subsets or supersets of each other are not disqualified
          from being equivalent for purposes of a VPP evaluation. If the VS takes the same code paths when executing PP-specified
          security functionality on different processors of the same family, then the processors can be considered equivalent with
          respect to that application.
        <h:br /><h:br />
        For example, if a VS follows one code path on platforms that support the AES-NI instruction and another on platforms that do
          not, then those two platforms are not equivalent with respect to that VS functionality. But if the VS follows the same code
          path whether or not the platform supports AES-NI, then the platforms are equivalent with respect to that functionality.
        <h:br /><h:br />
        The platforms are equivalent with respect to the VS if the platforms are equivalent with respect to all PP-specified
        security functionality.
        <h:table border="1">
          <h:tr class="header" bgcolor="#cccccc">
            <h:td valign="top">Factor</h:td>
            <h:td valign="top">Same/Different/None</h:td>
            <h:td valign="top">Guidance</h:td>
          </h:tr>
          <h:tr valign="top">
            <h:td valign="top">Platform Architectures</h:td>
            <h:td valign="top">Different</h:td>
            <h:td valign="top">Haardware platforms that implement different processor architectures and instruction sets are not equivalent.</h:td>
          </h:tr>
          <h:tr>
            <h:td valign="top">PP-Specified Functionality</h:td>
            <h:td valign="top">Same</h:td>
            <h:td valign="top">For platforms with the same processor architecture, the platforms are equivalent with
              respect to the application if execution of all PP-specified security functionality follows the same code path on
                both platforms.</h:td>
          </h:tr>
        </h:table>
        <h:b>Table 3. Factors for Determining Hardware Platform Equivalence</h:b>
        <h:br />
        <h:br />
      </subsection>
      <subsection id="os-equiv" title="Software Platform Equivalence">
        If the Product installs onto or integrates with an operating system that is not installed with the product--and thus
          is not part of the TOE--then the Product must be tested on all non-equivalent Software Platforms.
        <h:br />
        <h:br />
        The guidance for Product Model (Section 3) specifies that Products intended for use on substantially different operating
          systems (e.g. Windows vs. Linux vs. SunOS) are different Models. Therefore, platforms running substantially different
          operating systems are de facto not equivalent. Likewise, operating systems with different major version numbers are not
          equivalent for purposes of this PP.
        <h:br />
        <h:br />
          As a result, Software Platform equivalence is largely concerned with revisions and variations of operating systems that
          are substantially the same (e.g. different versions and revision levels of Windows or Linux).
        <h:table border="1">
          <h:tr class="header" bgcolor="#cccccc">
            <h:td valign="top">Factor</h:td>
            <h:td valign="top">Same/Different/None</h:td>
            <h:td valign="top">Guidance</h:td>
          </h:tr>
          <h:tr valign="top">
            <h:td valign="top">Platform Type/Vendor</h:td>
            <h:td valign="top">Different</h:td>
            <h:td valign="top">Operating systems that are substantially different or come from different vendors are not equivalent.</h:td>
          </h:tr>
          <h:tr valign="top">
            <h:td valign="top">Platform Versions</h:td>
            <h:td valign="top">Different</h:td>
            <h:td valign="top">Operating systems are not equivalent if they have different major version numbers.</h:td>
          </h:tr>
         <h:tr>
          <h:td rowspan="2" valign="top">PP-Specified Functionality</h:td>
          <h:td valign="top">Same</h:td>
          <h:td valign="top">If the differences between software platform models or versions affect only
              non-PP-specified functionality, then the software platforms are equivalent. </h:td>
        </h:tr>
        <h:tr>
          <h:td valign="top">Different</h:td>
          <h:td valign="top">If PP-specified security functionality is affected by the differences between software platform
              versions or models, then the software platforms are not considered equivalent and must be tested separately. It is
              necessary only to test the functionality affected by the changes. If only the differences are tested, then for each
              difference the Vendor must provide an explanation of why the difference does or does not affect PP-specified
              functionality. If the Products are fully tested on each platform, then there is no need to document the differences. </h:td>
        </h:tr>
        </h:table>
        <h:b>Table 4. Factors for Software Platform Equivalence</h:b>
        <h:br />
        <h:br />
    </subsection>
  </section>
    <section id="specificity" title="Level of Specificity for Tested Configurations and Claimed Equivalent Configurations">
      In order to make equivalency determinations, the vendor and evaluator must agree on the equivalency claims. They must
      then provide the scheme with sufficient information about the TOE instances and platforms that were evaluated, and the
      TOE instances and platforms that are claimed to be equivalent.
      <h:br /><h:br />
      The ST must describe all configurations evaluated down to processor manufacturer, model number, and microarchitecture version.
      <h:br /><h:br />
      The information regarding claimed equivalent configurations depends on the platform that the VS was developed for and runs on.
      <h:br /><h:br />
      <h:b>Bare-Metal VS</h:b>
      <h:br /><h:br />
      For VSes that run without an operating system on bare-metal or virtual bare-metal, the claimed configuration must
      describe the platform down to the specific processor manufacturer, model number, and microarchitecture version. The Vendor
      must describe the differences in the TOE with respect to PP-specified security functionality and how the TOE operates
      differently to leverage platform differences (e.g., instruction set extensions) in the tested configuration versus the
      claimed equivalent configuration.
      <h:br /><h:br />
      <h:b>VS with OS Support</h:b>
      <h:br /><h:br />
      For VSes that run on an OS host or with the assistance of an OS, then the claimed configuration must describe the OS down to
        its specific model and version number. The Vendor must describe the differences in the TOE with respect to PP-specified
        security functionality and how the TOE functions differently to leverage platform differences in the tested configuration
        versus the claimed equivalent configuration.
    </section>
    </appendix>
    
    <appendix id="ref" title="References">
      <bibliography>
        <cc-entry/>
        <entry id="bibCEM">
          <tag>CEM</tag>
          <description>
            <h:a href="http://www.commoncriteriaportal.org/files/ccfiles/CEMV3.1R5.pdf">Common
              Evaluation Methodology for Information Technology Security - Evaluation Methodology</h:a>,
              CCMB-2017-04-004, Version 3.1, Revision 5, April 2017. 
          </description>
        </entry>
      </bibliography>
    </appendix>
    <appendix id="acro" title="Acronyms">
      <acronyms/>
    </appendix>
</PP>

